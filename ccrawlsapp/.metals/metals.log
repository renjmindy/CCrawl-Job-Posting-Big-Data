[0m2021.02.24 16:50:48 INFO  Started: Metals version 0.10.0 in workspace '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp' for client vscode 1.53.2.[0m
[0m2021.02.24 16:50:49 INFO  time: initialize in 0.54s[0m
[0m2021.02.24 16:50:50 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher2764428711474357075/bsp.socket'...
Waiting for the bsp connection to come up...
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher2764428711474357075/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher2764428711474357075/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.24 16:50:50 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.24 16:50:50 INFO  time: Connected to build server in 0.5s[0m
[0m2021.02.24 16:50:50 INFO  Connected to Build server: Bloop v1.4.6-21-464e4ec4[0m
[0m2021.02.24 16:50:50 ERROR Empty build targets. Expected at least one build target identifier.[0m
[0m2021.02.24 16:50:50 ERROR Empty build targets. Expected at least one build target identifier.[0m
[0m2021.02.24 16:50:50 ERROR Empty build targets. Expected at least one build target identifier.[0m
[0m2021.02.24 16:50:50 INFO  time: Imported build in 0.15s[0m
[0m2021.02.24 16:50:50 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.24 16:50:50 INFO  time: indexed workspace in 0.14s[0m
[0m2021.02.25 04:42:45 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/build.sbt[0m
[0m2021.02.25 04:42:48 INFO  no build target: using presentation compiler with only scala-library: 2.12.13[0m
import Dependencies._

ThisBuild / scalaVersion     := "2.13.4"
ThisBuild / version          := "0.1.0-SNAPSHOT"
ThisBuild / organization     := "com.example"
ThisBuild / organizationName := "example"

lazy val root = (project in file("."))
  .settings(
    name := "ccrawlsapp",
    libraryDependencies += scalaTest % Test
  )

// See https://www.scala-sbt.org/1.x/docs/Using-Sonatype.html for instructions on how to publish to Sonatype.

[0m2021.02.25 04:42:52 INFO  time: code lens generation in 7.21s[0m
Feb 25, 2021 4:43:03 AM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 10
[0m2021.02.25 04:43:24 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/build.sbt[0m
import Dependencies._

ThisBuild / scalaVersion     := "2.11.12"
ThisBuild / version          := "0.1.0-SNAPSHOT"
ThisBuild / organization     := "com.revature"
ThisBuild / organizationName := "revature"

lazy val root = (project in file("."))
  .settings(
    name := "ccrawlsapp",
    libraryDependencies += scalaTest % Test
  )

// See https://www.scala-sbt.org/1.x/docs/Using-Sonatype.html for instructions on how to publish to Sonatype.

[0m2021.02.25 04:43:24 INFO  skipping build import with status 'Dismissed'[0m
[0m2021.02.25 04:43:29 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/example/Hello.scala[0m
package example

object Hello extends Greeting with App {
  println(greeting)
}

trait Greeting {
  lazy val greeting: String = "hello"
}

[0m2021.02.25 04:43:38 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/test/scala/example/HelloSpec.scala[0m
package example

import org.scalatest.flatspec.AnyFlatSpec
import org.scalatest.matchers.should.Matchers

class HelloSpec extends AnyFlatSpec with Matchers {
  "The Hello object" should "say hello" in {
    Hello.greeting shouldEqual "hello"
  }
}

[0m2021.02.25 05:22:25 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/build.sbt[0m
import Dependencies._

ThisBuild / scalaVersion     := "2.11.12"
ThisBuild / version          := "0.1.0-SNAPSHOT"
ThisBuild / organization     := "com.revature"
ThisBuild / organizationName := "revature"

lazy val root = (project in file("."))
  .settings(
    name := "ccrawlsapp",
    libraryDependencies += scalaTest % Test,
    libraryDependencies += "org.apache.spark" %% "spark-sql" % "2.4.7" % "provided",
    // https://mvnrepository.com/artifact/org.apache.httpcomponents/httpclient
    libraryDependencies += "org.apache.httpcomponents" % "httpclient" % "4.5.12",
    // https://mvnrepository.com/artifact/commons-io/commons-io
    libraryDependencies += "commons-io" % "commons-io" % "2.8.0",
    libraryDependencies += "org.apache.hadoop" % "hadoop-common" % "3.0.0",
    libraryDependencies += "org.apache.hadoop" % "hadoop-client" % "3.0.0",
    libraryDependencies += "org.apache.hadoop" % "hadoop-aws" % "3.0.0"
  )

  assemblyMergeStrategy in assembly := {
    case PathList("META-INF", xs @ _*) => MergeStrategy.discard
    case x => MergeStrategy.first
  }

  // See https://www.scala-sbt.org/1.x/docs/Using-Sonatype.html for instructions on how to publish to Sonatype.
import Dependencies._

ThisBuild / scalaVersion     := "2.11.12"
ThisBuild / version          := "0.1.0-SNAPSHOT"
ThisBuild / organization     := "com.revature"
ThisBuild / organizationName := "revature"

lazy val root = (project in file("."))
  .settings(
    name := "ccrawlsapp",
    libraryDependencies += scalaTest % Test,
    libraryDependencies += "org.apache.spark" %% "spark-sql" % "2.4.7" % "provided",
    // https://mvnrepository.com/artifact/org.apache.httpcomponents/httpclient
    libraryDependencies += "org.apache.httpcomponents" % "httpclient" % "4.5.12",
    // https://mvnrepository.com/artifact/commons-io/commons-io
    libraryDependencies += "commons-io" % "commons-io" % "2.8.0",
    libraryDependencies += "org.apache.hadoop" % "hadoop-common" % "3.0.0",
    libraryDependencies += "org.apache.hadoop" % "hadoop-client" % "3.0.0",
    libraryDependencies += "org.apache.hadoop" % "hadoop-aws" % "3.0.0"
  )

  assemblyMergeStrategy in assembly := {
    case PathList("META-INF", xs @ _*) => MergeStrategy.discard
    case x => MergeStrategy.first
  }

  // See https://www.scala-sbt.org/1.x/docs/Using-Sonatype.html for instructions on how to publish to Sonatype.
[0m2021.02.25 05:23:41 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala[0m
















[0m2021.02.25 05:41:43 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala[0m
package ccrawlsapp


[0m2021.02.25 05:54:45 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala[0m
package ccrawlsapp

import org.apache.spark.sql.SparkSession

object Runner {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession
      .builder()
      .appName("scalas3read")
      .master("local[4]")
      .getOrCreate()

    // Reference: https://sparkbyexamples.com/spark/spark-read-text-file-from-s3/#s3-dependency
    val key = System.getenv(("DAS_KEY_ID"))
    val secret = System.getenv(("DAS_SEC"))

    spark.sparkContext.hadoopConfiguration.set("fs.s3a.access.key", key)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.secret.key", secret)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.endpoint", "s3.amazonaws.com")
    
    import spark.implicits._
    spark.sparkContext.setLogLevel("WARN")

    val s3DataMaybe = spark.read.text("s3a://usf-210104-big-data/twitterstream/tweetstream-1613536993819-1")
    s3DataMaybe.show()
  }
}
[0m2021.02.25 05:54:54 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/Dependencies.scala[0m
import sbt._

object Dependencies {
  lazy val scalaTest = "org.scalatest" %% "scalatest" % "3.2.2"
}

[0m2021.02.25 05:55:03 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/plugins.sbt[0m



[0m2021.02.25 05:55:03 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/plugins.sbt[0m

[0m2021.02.25 05:55:03 INFO  skipping build import with status 'Requested'[0m






[0m2021.02.25 05:55:21 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/plugins.sbt[0m
addSbtPlugin("com.eed3si9n" % "sbt-assembly" % "0.15.0")
[0m2021.02.25 05:55:24 INFO  running '/usr/lib/jvm/java-8-openjdk-amd64/bin/java -Djline.terminal=jline.UnsupportedTerminal -Dsbt.log.noformat=true -Dfile.encoding=UTF-8 -jar /tmp/metals7964881552150152204/sbt-launch.jar -Dbloop.export-jar-classifiers=sources bloopInstall'[0m
addSbtPlugin("com.eed3si9n" % "sbt-assembly" % "0.15.0")
[0m2021.02.25 05:55:24 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/metals.sbt[0m
[0m2021.02.25 05:55:24 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project/metals.sbt[0m
// DO NOT EDIT! This file is auto-generated.
// This file enables sbt-bloop to create bloop config files.

addSbtPlugin("ch.epfl.scala" % "sbt-bloop" % "1.4.8")

// DO NOT EDIT! This file is auto-generated.
// This file enables sbt-bloop to create bloop config files.

addSbtPlugin("ch.epfl.scala" % "sbt-bloop" % "1.4.8")

[0m2021.02.25 05:55:26 INFO  [info] welcome to sbt 1.4.7 (Private Build Java 1.8.0_275)[0m
Feb 25, 2021 5:55:28 AM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 275
[0m2021.02.25 05:55:29 INFO  [info] loading settings for project ccrawlsapp-build-build-build from metals.sbt ...[0m
[0m2021.02.25 05:55:29 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project/project[0m
Feb 25, 2021 5:55:32 AM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 280
package ccrawlsapp

import org.apache.spark.sql.SparkSession

object Runner {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession
      .builder()
      .appName("scalas3read")
      .master("local[4]")
      .getOrCreate()

    // Reference: https://sparkbyexamples.com/spark/spark-read-text-file-from-s3/#s3-dependency
    val key = System.getenv(("DAS_KEY_ID"))
    val secret = System.getenv(("DAS_SEC"))

    spark.sparkContext.hadoopConfiguration.set("fs.s3a.access.key", key)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.secret.key", secret)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.endpoint", "s3.amazonaws.com")
    
    import spark.implicits._
    spark.sparkContext.setLogLevel("WARN")

    val s3DataMaybe = spark.read.text("s3a://usf-210104-big-data/twitterstream/tweetstream-1613536993819-1")
    s3DataMaybe.show()
  }
}
package ccrawlsapp

import org.apache.spark.sql.SparkSession

object Runner {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession
      .builder()
      .appName("scalas3read")
      .master("local[4]")
      .getOrCreate()

    // Reference: https://sparkbyexamples.com/spark/spark-read-text-file-from-s3/#s3-dependency
    val key = System.getenv(("DAS_KEY_ID"))
    val secret = System.getenv(("DAS_SEC"))

    spark.sparkContext.hadoopConfiguration.set("fs.s3a.access.key", key)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.secret.key", secret)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.endpoint", "s3.amazonaws.com")
    
    import spark.implicits._
    spark.sparkContext.setLogLevel("WARN")

    val s3DataMaybe = spark.read.text("s3a://usf-210104-big-data/twitterstream/tweetstream-1613536993819-1")
    s3DataMaybe.show()
  }
}
[0m2021.02.25 05:55:37 INFO  [info] loading settings for project ccrawlsapp-build-build from metals.sbt ...[0m
[0m2021.02.25 05:55:37 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project[0m
[0m2021.02.25 05:55:39 INFO  [success] Generated .bloop/ccrawlsapp-build-build.json[0m
[0m2021.02.25 05:55:39 INFO  [success] Total time: 2 s, completed Feb 25, 2021 5:55:39 AM[0m
[0m2021.02.25 05:55:40 INFO  [info] loading settings for project ccrawlsapp-build from metals.sbt,plugins.sbt ...[0m
[0m2021.02.25 05:55:40 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project[0m
[0m2021.02.25 05:55:42 INFO  [success] Generated .bloop/ccrawlsapp-build.json[0m
[0m2021.02.25 05:55:43 INFO  [info] compiling 1 Scala source to /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/target/scala-2.12/sbt-1.0/classes ...[0m
[0m2021.02.25 05:55:46 INFO  [info] done compiling[0m
[0m2021.02.25 05:55:46 INFO  [success] Total time: 6 s, completed Feb 25, 2021 5:55:46 AM[0m
[0m2021.02.25 05:55:48 INFO  [info] loading settings for project root from build.sbt ...[0m
[0m2021.02.25 05:55:48 INFO  [info] set current project to ccrawlsapp (in build file:/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/)[0m
[0m2021.02.25 05:56:22 INFO  [warn] There may be incompatibilities among your library dependencies; run 'evicted' to see detailed eviction warnings.[0m
[0m2021.02.25 05:56:44 INFO  [warn] There may be incompatibilities among your library dependencies; run 'evicted' to see detailed eviction warnings.[0m
[0m2021.02.25 05:56:44 INFO  [success] Generated .bloop/root-test.json[0m
[0m2021.02.25 05:56:44 INFO  [success] Generated .bloop/root.json[0m
[0m2021.02.25 05:56:44 INFO  [success] Total time: 55 s, completed Feb 25, 2021 5:56:44 AM[0m
[0m2021.02.25 05:56:44 INFO  sbt bloopInstall exit: 0[0m
[0m2021.02.25 05:56:45 INFO  time: ran 'sbt bloopInstall' in 1m20s[0m
[0m2021.02.25 05:56:45 INFO  Disconnecting from Bloop session...[0m
[0m2021.02.25 05:56:45 INFO  Shut down connection with build server.[0m
No more data in the client stdin, exiting...
[0m2021.02.25 05:56:45 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher1705575613681463189/bsp.socket'...
Waiting for the bsp connection to come up...
[0m2021.02.25 05:56:45 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 05:56:55 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 05:56:55 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 05:56:55 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 05:56:55 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 05:56:59 INFO  time: Connected to build server in 14s[0m
[0m2021.02.25 05:56:59 INFO  Connected to Build server: Bloop v1.4.6-21-464e4ec4[0m
[0m2021.02.25 05:57:03 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.25 05:57:08 INFO  time: indexed workspace in 8.07s[0m
[0m2021.02.25 06:06:11 INFO  skipping build import with status 'Installed'[0m
[0m2021.02.25 06:06:12 INFO  compiling ccrawlsapp-build (1 scala source)[0m
[0m2021.02.25 06:06:12 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:06:14 INFO  time: compiled root in 1.78s[0m
[0m2021.02.25 06:06:15 INFO  time: compiled ccrawlsapp-build in 3.58s[0m
[0m2021.02.25 06:06:36 INFO  running '/usr/lib/jvm/java-8-openjdk-amd64/bin/java -Djline.terminal=jline.UnsupportedTerminal -Dsbt.log.noformat=true -Dfile.encoding=UTF-8 -jar /tmp/metals4438654373354856586/sbt-launch.jar -Dbloop.export-jar-classifiers=sources bloopInstall'[0m
[0m2021.02.25 06:06:37 INFO  [info] welcome to sbt 1.4.7 (Private Build Java 1.8.0_275)[0m
[0m2021.02.25 06:06:38 INFO  [info] loading settings for project ccrawlsapp-build-build-build from metals.sbt ...[0m
[0m2021.02.25 06:06:38 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project/project[0m
[0m2021.02.25 06:06:40 INFO  [info] loading settings for project ccrawlsapp-build-build from metals.sbt ...[0m
[0m2021.02.25 06:06:40 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project[0m
[0m2021.02.25 06:06:42 INFO  [success] Generated .bloop/ccrawlsapp-build-build.json[0m
[0m2021.02.25 06:06:42 INFO  [success] Total time: 2 s, completed Feb 25, 2021 6:06:42 AM[0m
[0m2021.02.25 06:06:42 INFO  [info] loading settings for project ccrawlsapp-build from metals.sbt,plugins.sbt ...[0m
[0m2021.02.25 06:06:42 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project[0m
[0m2021.02.25 06:06:43 INFO  [success] Generated .bloop/ccrawlsapp-build.json[0m
[0m2021.02.25 06:06:43 INFO  [success] Total time: 1 s, completed Feb 25, 2021 6:06:44 AM[0m
[0m2021.02.25 06:06:43 INFO  [info] loading settings for project root from build.sbt ...[0m
[0m2021.02.25 06:06:44 INFO  [info] set current project to ccrawlsapp (in build file:/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/)[0m
[0m2021.02.25 06:06:45 INFO  [success] Generated .bloop/root-test.json[0m
[0m2021.02.25 06:06:45 INFO  [success] Generated .bloop/root.json[0m
[0m2021.02.25 06:06:45 INFO  [success] Total time: 1 s, completed Feb 25, 2021 6:06:45 AM[0m
[0m2021.02.25 06:06:45 INFO  sbt bloopInstall exit: 0[0m
[0m2021.02.25 06:06:46 INFO  time: ran 'sbt bloopInstall' in 10s[0m
[0m2021.02.25 06:06:46 INFO  Disconnecting from Bloop session...[0m
[0m2021.02.25 06:06:46 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:06:46 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:06:46 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:06:46 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:06:46 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:06:46 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:06:46 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:06:46 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:06:46 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:06:46 INFO  time: Connected to build server in 0.19s[0m
[0m2021.02.25 06:06:46 INFO  Connected to Build server: Bloop v1.4.6-21-464e4ec4[0m
[0m2021.02.25 06:06:48 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.25 06:06:48 INFO  time: indexed workspace in 1.48s[0m
[0m2021.02.25 06:07:16 INFO  Disconnecting from Bloop session...[0m
[0m2021.02.25 06:07:16 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:07:16 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:07:16 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:07:16 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:07:21 INFO  running '/usr/lib/jvm/java-8-openjdk-amd64/bin/java -Djline.terminal=jline.UnsupportedTerminal -Dsbt.log.noformat=true -Dfile.encoding=UTF-8 -jar /tmp/metals1181505036510653155/sbt-launch.jar -Dbloop.export-jar-classifiers=sources bloopInstall'[0m
[0m2021.02.25 06:07:22 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:07:22 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:07:22 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:07:23 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:07:23 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:07:23 INFO  time: Connected to build server in 6.54s[0m
[0m2021.02.25 06:07:23 INFO  Connected to Build server: Bloop v1.4.8[0m
[0m2021.02.25 06:07:23 INFO  [info] welcome to sbt 1.4.7 (Private Build Java 1.8.0_275)[0m
[0m2021.02.25 06:07:23 INFO  time: Imported build in 0.28s[0m
[0m2021.02.25 06:07:26 INFO  [info] loading settings for project ccrawlsapp-build-build-build from metals.sbt ...[0m
[0m2021.02.25 06:07:26 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project/project[0m
[0m2021.02.25 06:07:27 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.25 06:07:27 INFO  time: indexed workspace in 3.5s[0m
[0m2021.02.25 06:07:29 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:07:29 INFO  compiling ccrawlsapp-build (1 scala source)[0m
[0m2021.02.25 06:07:29 INFO  [info] loading settings for project ccrawlsapp-build-build from metals.sbt ...[0m
[0m2021.02.25 06:07:29 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project[0m
[0m2021.02.25 06:07:33 INFO  [success] Generated .bloop/ccrawlsapp-build-build.json[0m
[0m2021.02.25 06:07:33 INFO  [success] Total time: 4 s, completed Feb 25, 2021 6:07:33 AM[0m
[0m2021.02.25 06:07:34 INFO  [info] loading settings for project ccrawlsapp-build from metals.sbt,plugins.sbt ...[0m
[0m2021.02.25 06:07:34 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project[0m
[0m2021.02.25 06:07:35 INFO  [success] Generated .bloop/ccrawlsapp-build.json[0m
[0m2021.02.25 06:07:37 INFO  time: compiled root in 7.83s[0m
[0m2021.02.25 06:07:37 INFO  [success] Total time: 3 s, completed Feb 25, 2021 6:07:37 AM[0m
[0m2021.02.25 06:07:37 INFO  [info] loading settings for project root from build.sbt ...[0m
[0m2021.02.25 06:07:37 INFO  time: compiled ccrawlsapp-build in 8.61s[0m
[0m2021.02.25 06:07:37 INFO  [info] set current project to ccrawlsapp (in build file:/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/)[0m
[0m2021.02.25 06:07:38 INFO  [success] Generated .bloop/root-test.json[0m
[0m2021.02.25 06:07:38 INFO  [success] Generated .bloop/root.json[0m
[0m2021.02.25 06:07:38 INFO  [success] Total time: 1 s, completed Feb 25, 2021 6:07:39 AM[0m
[0m2021.02.25 06:07:38 INFO  sbt bloopInstall exit: 0[0m
[0m2021.02.25 06:07:39 INFO  time: ran 'sbt bloopInstall' in 18s[0m
[0m2021.02.25 06:07:39 INFO  Disconnecting from Bloop session...[0m
[0m2021.02.25 06:07:39 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:07:39 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:07:39 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:07:39 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:07:39 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:07:39 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:07:39 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:07:39 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:07:39 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:07:39 INFO  time: Connected to build server in 0.14s[0m
[0m2021.02.25 06:07:39 INFO  Connected to Build server: Bloop v1.4.8[0m
[0m2021.02.25 06:07:41 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.25 06:07:41 INFO  time: indexed workspace in 1.75s[0m
[0m2021.02.25 06:21:24 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:21:26 INFO  time: compiled root in 1.57s[0m
[0m2021.02.25 06:22:34 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:22:36 INFO  time: compiled root in 1.68s[0m
[0m2021.02.25 06:38:12 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:38:13 INFO  time: compiled root in 1.15s[0m
[0m2021.02.25 06:40:02 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:40:04 INFO  time: compiled root in 1.38s[0m
[0m2021.02.25 06:40:17 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:40:18 INFO  time: compiled root in 1.58s[0m
[0m2021.02.25 06:52:26 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:52:27 INFO  time: compiled root in 1.54s[0m
[0m2021.02.25 06:56:13 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:56:13 INFO  time: compiled root in 0.4s[0m
[0m2021.02.25 06:56:31 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:56:31 INFO  time: compiled root in 0.4s[0m
[0m2021.02.25 06:56:46 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 06:56:46 INFO  time: compiled root in 0.81s[0m
[0m2021.02.25 06:56:51 INFO  running '/usr/lib/jvm/java-8-openjdk-amd64/bin/java -Djline.terminal=jline.UnsupportedTerminal -Dsbt.log.noformat=true -Dfile.encoding=UTF-8 -jar /tmp/metals4926634773360938248/sbt-launch.jar -Dbloop.export-jar-classifiers=sources bloopInstall'[0m
[0m2021.02.25 06:56:53 INFO  [info] welcome to sbt 1.4.7 (Private Build Java 1.8.0_275)[0m
[0m2021.02.25 06:56:55 INFO  [info] loading settings for project ccrawlsapp-build-build-build from metals.sbt ...[0m
[0m2021.02.25 06:56:55 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project/project[0m
[0m2021.02.25 06:56:56 INFO  [info] loading settings for project ccrawlsapp-build-build from metals.sbt ...[0m
[0m2021.02.25 06:56:56 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project[0m
[0m2021.02.25 06:56:59 INFO  [success] Generated .bloop/ccrawlsapp-build-build.json[0m
[0m2021.02.25 06:56:59 INFO  [success] Total time: 2 s, completed Feb 25, 2021 6:56:59 AM[0m
[0m2021.02.25 06:56:59 INFO  [info] loading settings for project ccrawlsapp-build from metals.sbt,plugins.sbt ...[0m
[0m2021.02.25 06:56:59 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project[0m
[0m2021.02.25 06:57:00 INFO  [success] Generated .bloop/ccrawlsapp-build.json[0m
[0m2021.02.25 06:57:00 INFO  [success] Total time: 1 s, completed Feb 25, 2021 6:57:00 AM[0m
[0m2021.02.25 06:57:00 INFO  [info] loading settings for project root from build.sbt ...[0m
[0m2021.02.25 06:57:01 INFO  [info] set current project to ccrawlsapp (in build file:/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/)[0m
[0m2021.02.25 06:57:02 INFO  [success] Generated .bloop/root.json[0m
[0m2021.02.25 06:57:02 INFO  [success] Generated .bloop/root-test.json[0m
[0m2021.02.25 06:57:02 INFO  [success] Total time: 1 s, completed Feb 25, 2021 6:57:02 AM[0m
[0m2021.02.25 06:57:02 INFO  sbt bloopInstall exit: 0[0m
[0m2021.02.25 06:57:02 INFO  time: ran 'sbt bloopInstall' in 10s[0m
[0m2021.02.25 06:57:02 INFO  Disconnecting from Bloop session...[0m
[0m2021.02.25 06:57:02 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:57:02 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:57:02 INFO  Shut down connection with build server.[0m
[0m2021.02.25 06:57:02 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:57:03 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:57:03 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:57:03 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 06:57:03 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:57:03 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 06:57:03 INFO  time: Connected to build server in 0.18s[0m
[0m2021.02.25 06:57:03 INFO  Connected to Build server: Bloop v1.4.8[0m
[0m2021.02.25 06:57:06 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.25 06:57:06 INFO  time: indexed workspace in 3.07s[0m
[0m2021.02.25 07:00:40 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 07:00:40 INFO  time: compiled root in 0.29s[0m
[0m2021.02.25 07:00:50 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 07:00:50 INFO  time: compiled root in 0.98s[0m
[0m2021.02.25 07:10:57 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 07:10:57 INFO  time: compiled root in 0.99s[0m
[0m2021.02.25 07:12:46 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 07:12:46 INFO  time: compiled root in 0.9s[0m
[0m2021.02.25 07:15:57 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 07:15:58 INFO  time: compiled root in 1.22s[0m
[0m2021.02.25 07:17:16 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 07:17:16 INFO  time: compiled root in 0.97s[0m
[0m2021.02.25 07:39:52 INFO  running '/usr/lib/jvm/java-8-openjdk-amd64/bin/java -Djline.terminal=jline.UnsupportedTerminal -Dsbt.log.noformat=true -Dfile.encoding=UTF-8 -jar /tmp/metals9135312067981038499/sbt-launch.jar -Dbloop.export-jar-classifiers=sources bloopInstall'[0m
[0m2021.02.25 07:39:54 INFO  [info] welcome to sbt 1.4.7 (Private Build Java 1.8.0_275)[0m
[0m2021.02.25 07:39:56 INFO  [info] loading settings for project ccrawlsapp-build-build-build from metals.sbt ...[0m
[0m2021.02.25 07:39:57 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project/project[0m
[0m2021.02.25 07:39:58 INFO  [info] loading settings for project ccrawlsapp-build-build from metals.sbt ...[0m
[0m2021.02.25 07:39:58 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project[0m
[0m2021.02.25 07:40:00 INFO  [success] Generated .bloop/ccrawlsapp-build-build.json[0m
[0m2021.02.25 07:40:00 INFO  [success] Total time: 2 s, completed Feb 25, 2021 7:40:01 AM[0m
[0m2021.02.25 07:40:00 INFO  [info] loading settings for project ccrawlsapp-build from metals.sbt,plugins.sbt ...[0m
[0m2021.02.25 07:40:00 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project[0m
[0m2021.02.25 07:40:02 INFO  [success] Generated .bloop/ccrawlsapp-build.json[0m
[0m2021.02.25 07:40:02 INFO  [success] Total time: 2 s, completed Feb 25, 2021 7:40:03 AM[0m
[0m2021.02.25 07:40:07 INFO  [info] loading settings for project root from build.sbt ...[0m
[0m2021.02.25 07:40:07 INFO  [info] set current project to ccrawlsapp (in build file:/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/)[0m
[0m2021.02.25 07:40:20 INFO  [warn] There may be incompatibilities among your library dependencies; run 'evicted' to see detailed eviction warnings.[0m
[0m2021.02.25 07:40:26 INFO  [warn] There may be incompatibilities among your library dependencies; run 'evicted' to see detailed eviction warnings.[0m
[0m2021.02.25 07:40:26 INFO  [success] Generated .bloop/root.json[0m
[0m2021.02.25 07:40:26 INFO  [success] Generated .bloop/root-test.json[0m
[0m2021.02.25 07:40:26 INFO  [success] Total time: 19 s, completed Feb 25, 2021 7:40:26 AM[0m
[0m2021.02.25 07:40:27 INFO  sbt bloopInstall exit: 0[0m
[0m2021.02.25 07:40:27 INFO  time: ran 'sbt bloopInstall' in 34s[0m
[0m2021.02.25 07:40:27 INFO  Disconnecting from Bloop session...[0m
[0m2021.02.25 07:40:27 INFO  Shut down connection with build server.[0m
[0m2021.02.25 07:40:27 INFO  Shut down connection with build server.[0m
[0m2021.02.25 07:40:27 INFO  Shut down connection with build server.[0m
[0m2021.02.25 07:40:27 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 07:40:27 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 07:40:27 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 07:40:27 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 07:40:27 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 07:40:27 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 07:40:27 INFO  time: Connected to build server in 0.17s[0m
[0m2021.02.25 07:40:27 INFO  Connected to Build server: Bloop v1.4.8[0m
[0m2021.02.25 07:40:31 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.25 07:40:31 INFO  time: indexed workspace in 3.74s[0m
[0m2021.02.25 07:40:32 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 07:40:34 INFO  time: compiled root in 1.8s[0m
[0m2021.02.25 09:40:08 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 09:40:11 INFO  time: compiled root in 3.72s[0m
[0m2021.02.25 10:10:42 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 10:10:45 INFO  time: compiled root in 2.45s[0m
[0m2021.02.25 10:27:38 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 10:27:40 INFO  time: compiled root in 1.27s[0m
[0m2021.02.25 10:28:40 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 10:28:42 INFO  time: compiled root in 1.96s[0m
[0m2021.02.25 10:30:04 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 10:30:07 INFO  time: compiled root in 3.32s[0m
[0m2021.02.25 10:32:06 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 10:32:07 INFO  time: compiled root in 1.08s[0m
[0m2021.02.25 10:39:14 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 10:39:14 INFO  time: compiled root in 0.92s[0m
[0m2021.02.25 10:42:32 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 10:42:33 INFO  time: compiled root in 1.23s[0m
[0m2021.02.25 10:43:20 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 10:43:22 INFO  time: compiled root in 2.17s[0m
[0m2021.02.25 10:54:11 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 10:54:11 INFO  time: compiled root in 0.8s[0m
[0m2021.02.25 10:56:28 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 10:56:28 INFO  time: compiled root in 0.91s[0m
[0m2021.02.25 11:02:11 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 11:02:11 INFO  time: compiled root in 0.9s[0m
[0m2021.02.25 11:02:22 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 11:02:22 INFO  time: compiled root in 0.83s[0m
[0m2021.02.25 11:44:16 INFO  shutting down Metals[0m
[0m2021.02.25 11:44:16 INFO  Shut down connection with build server.[0m
[0m2021.02.25 11:44:16 INFO  Shut down connection with build server.[0m
[0m2021.02.25 11:44:16 INFO  Shut down connection with build server.[0m
[0m2021.02.25 11:45:27 INFO  Started: Metals version 0.10.0 in workspace '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp' for client vscode 1.53.2.[0m
[0m2021.02.25 11:45:28 INFO  time: initialize in 1.36s[0m
[0m2021.02.25 11:45:29 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher5443227878594597081/bsp.socket'...
Waiting for the bsp connection to come up...
[0m2021.02.25 11:45:28 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala[0m
[0m2021.02.25 11:45:30 INFO  skipping build import with status 'Installed'[0m
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
[0m2021.02.25 11:45:34 INFO  no build target: using presentation compiler with only scala-library: 2.12.13[0m
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
package com.revature.ccrawlsapp

import com.amazonaws.services.s3.AmazonS3Client
import com.amazonaws.auth.BasicAWSCredentials
import org.apache.spark.sql.SparkSession

object Runner {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession
      .builder()
      .appName("scalas3read")
      .master("local[4]")
      .getOrCreate()

    // Reference: https://sparkbyexamples.com/spark/spark-read-text-file-from-s3/#s3-dependency
    val key = System.getenv(("AWS_ACCESS_KEY_ID"))
    val secret = System.getenv(("AWS_SECRET_ACCESS_KEY"))

    spark.sparkContext.hadoopConfiguration.set("fs.s3a.access.key", key)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.secret.key", secret)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.endpoint", "s3.amazonaws.com")
    
    import spark.implicits._
    spark.sparkContext.setLogLevel("WARN")

    //val s3DataMaybe = spark.read.text("s3a://usf-210104-big-data/twitterstream/tweetstream-1613536993819-1")
    //val s3DataMaybe = spark.sparkContext.textFile("s3a://bigdata-pj2-teammindy/data/tweets.json")
    //val s3DataMaybe = spark.sparkContext.textFile("s3a://commoncrawl/crawl-data/CC-MAIN-2021-04/segments/1610704847953.98/wat/CC-MAIN-20210128134124-20210128164124-00799.warc.wat.gz")
    //val s3DataMaybe = spark.read.option("inferSchema", "true").text("s3a://commoncrawl/crawl-data/CC-MAIN-2021-04/segments/1610704847953.98/wat/CC-MAIN-20210128134124-20210128164124-00799.warc.wat.gz")
    //val s3DataMaybe = spark.read.json("s3a://commoncrawl/crawl-data/CC-MAIN-2021-04/segments/1610704847953.98/wat/CC-MAIN-20210128134124-20210128164124-00799.warc.wat.gz")
    //s3DataMaybe.printSchema()
    //s3DataMaybe.collect.foreach(println)
    //s3DataMaybe.show()
    //s3DataMaybe.take(50).foreach(println)
    //s3DataMaybe.take(50).foreach(println)
    //s3DataMaybe.take(1).foreach(println)
    //s3DataMaybe.show(100, false)

    val rddFromFile = spark.read.json("s3a://commoncrawl/crawl-data/CC-MAIN-2021-04/segments/1610704847953.98/wat/CC-MAIN-20210128134124-20210128164124-00799.warc.wat.gz" ) 
    rddFromFile.printSchema()
    rddFromFile.take(1).foreach(println)

  }
}
Waiting for the bsp connection to come up...
package com.revature.ccrawlsapp

import com.amazonaws.services.s3.AmazonS3Client
import com.amazonaws.auth.BasicAWSCredentials
import org.apache.spark.sql.SparkSession

object Runner {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession
      .builder()
      .appName("scalas3read")
      .master("local[4]")
      .getOrCreate()

    // Reference: https://sparkbyexamples.com/spark/spark-read-text-file-from-s3/#s3-dependency
    val key = System.getenv(("AWS_ACCESS_KEY_ID"))
    val secret = System.getenv(("AWS_SECRET_ACCESS_KEY"))

    spark.sparkContext.hadoopConfiguration.set("fs.s3a.access.key", key)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.secret.key", secret)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.endpoint", "s3.amazonaws.com")
    
    import spark.implicits._
    spark.sparkContext.setLogLevel("WARN")

    //val s3DataMaybe = spark.read.text("s3a://usf-210104-big-data/twitterstream/tweetstream-1613536993819-1")
    //val s3DataMaybe = spark.sparkContext.textFile("s3a://bigdata-pj2-teammindy/data/tweets.json")
    //val s3DataMaybe = spark.sparkContext.textFile("s3a://commoncrawl/crawl-data/CC-MAIN-2021-04/segments/1610704847953.98/wat/CC-MAIN-20210128134124-20210128164124-00799.warc.wat.gz")
    //val s3DataMaybe = spark.read.option("inferSchema", "true").text("s3a://commoncrawl/crawl-data/CC-MAIN-2021-04/segments/1610704847953.98/wat/CC-MAIN-20210128134124-20210128164124-00799.warc.wat.gz")
    //val s3DataMaybe = spark.read.json("s3a://commoncrawl/crawl-data/CC-MAIN-2021-04/segments/1610704847953.98/wat/CC-MAIN-20210128134124-20210128164124-00799.warc.wat.gz")
    //s3DataMaybe.printSchema()
    //s3DataMaybe.collect.foreach(println)
    //s3DataMaybe.show()
    //s3DataMaybe.take(50).foreach(println)
    //s3DataMaybe.take(50).foreach(println)
    //s3DataMaybe.take(1).foreach(println)
    //s3DataMaybe.show(100, false)

    val rddFromFile = spark.read.json("s3a://commoncrawl/crawl-data/CC-MAIN-2021-04/segments/1610704847953.98/wat/CC-MAIN-20210128134124-20210128164124-00799.warc.wat.gz" ) 
    rddFromFile.printSchema()
    rddFromFile.take(1).foreach(println)

  }
}
[0m2021.02.25 11:45:37 INFO  time: code lens generation in 7.68s[0m
No server running at 127.0.0.1:8212, let's fire one...
Resolving ch.epfl.scala:bloop-frontend_2.12:1.4.8...
Starting bloop server at 127.0.0.1:8212...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Loading 2 projects from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop'...
[0m[32m[D][0m Loading project from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop/root-test.json'
[0m[32m[D][0m Loading project from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop/root.json'
[0m[32m[D][0m Cache miss for scala instance org.scala-lang:scala-compiler:2.11.12.
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/jline/jline/2.14.3/jline-2.14.3.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/modules/scala-parser-combinators_2.11/1.0.4/scala-parser-combinators_2.11-1.0.4.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/modules/scala-xml_2.11/1.0.5/scala-xml_2.11-1.0.5.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-compiler/2.11.12/scala-compiler-2.11.12.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-library/2.11.12/scala-library-2.11.12.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-reflect/2.11.12/scala-reflect-2.11.12.jar
[0m[32m[D][0m Configured SemanticDB in projects 'root-test', 'root'
[0m[32m[D][0m Missing analysis file for project 'root-test'
[0m[32m[D][0m Loading previous analysis for 'root' from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/target/streams/compile/bloopAnalysisOut/_global/streams/inc_compile_2.11.zip'.
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher5443227878594597081/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher5443227878594597081/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.25 11:45:37 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 11:45:37 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
[0m2021.02.25 11:45:37 INFO  Attempting to connect to the build server...[0m
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher168508699838176953/bsp.socket'...
Waiting for the bsp connection to come up...
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher3657089170965375674/bsp.socket'...
Waiting for the bsp connection to come up...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher168508699838176953/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher168508699838176953/bsp.socket...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher3657089170965375674/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher3657089170965375674/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.25 11:45:38 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 11:45:38 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 11:45:38 INFO  time: Connected to build server in 8.81s[0m
[0m2021.02.25 11:45:38 INFO  Connected to Build server: Bloop v1.4.8[0m
[0m2021.02.25 11:45:38 INFO  time: Imported build in 0.2s[0m
[0m2021.02.25 11:45:40 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.25 11:45:40 INFO  time: indexed workspace in 2.57s[0m
Feb 25, 2021 1:30:21 PM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 71
Feb 25, 2021 1:30:21 PM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 74
Feb 25, 2021 1:30:21 PM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 72
[0m2021.02.25 13:31:22 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 13:31:30 INFO  time: compiled root in 8.19s[0m
[0m2021.02.25 13:34:47 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 13:34:47 INFO  time: compiled root in 0.59s[0m
[0m2021.02.25 13:35:07 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 13:35:07 INFO  time: compiled root in 0.35s[0m
[0m2021.02.25 13:35:28 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 13:35:30 INFO  time: compiled root in 1.47s[0m
[0m2021.02.25 13:35:57 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 13:35:57 INFO  time: compiled root in 0.27s[0m
[0m2021.02.25 13:36:03 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 13:36:05 INFO  time: compiled root in 1.61s[0m
[0m2021.02.25 13:36:08 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 13:36:09 INFO  time: compiled root in 1.13s[0m
Feb 25, 2021 1:42:15 PM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 721
Feb 25, 2021 1:42:15 PM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 724
Feb 25, 2021 1:42:15 PM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 723
[0m2021.02.25 13:48:10 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 13:48:10 INFO  time: compiled root in 0.94s[0m
[0m2021.02.25 13:48:42 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 13:48:44 INFO  time: compiled root in 1.16s[0m
[0m2021.02.25 14:04:48 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 14:04:49 INFO  time: compiled root in 1.09s[0m
[0m2021.02.25 14:22:58 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 14:22:59 INFO  time: compiled root in 1.48s[0m
[0m2021.02.25 14:24:55 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 14:24:55 INFO  time: compiled root in 0.86s[0m
[0m2021.02.25 14:26:05 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 14:26:05 INFO  time: compiled root in 0.74s[0m
[0m2021.02.25 14:27:25 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 14:27:25 INFO  time: compiled root in 0.87s[0m
[0m2021.02.25 14:32:51 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 14:32:53 INFO  time: compiled root in 1.19s[0m
[0m2021.02.25 14:32:57 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 14:32:59 INFO  time: compiled root in 1.52s[0m
[0m2021.02.25 14:33:30 INFO  running '/usr/lib/jvm/java-8-openjdk-amd64/bin/java -Djline.terminal=jline.UnsupportedTerminal -Dsbt.log.noformat=true -Dfile.encoding=UTF-8 -jar /tmp/metals480003110084130984/sbt-launch.jar -Dbloop.export-jar-classifiers=sources bloopInstall'[0m
[0m2021.02.25 14:33:32 INFO  running '/usr/lib/jvm/java-8-openjdk-amd64/bin/java -Djline.terminal=jline.UnsupportedTerminal -Dsbt.log.noformat=true -Dfile.encoding=UTF-8 -jar /tmp/metals6836715666082051987/sbt-launch.jar -Dbloop.export-jar-classifiers=sources bloopInstall'[0m
[0m2021.02.25 14:33:32 INFO  [info] welcome to sbt 1.4.7 (Private Build Java 1.8.0_275)[0m
[0m2021.02.25 14:33:36 INFO  [info] loading settings for project ccrawlsapp-build-build-build from metals.sbt ...[0m
[0m2021.02.25 14:33:37 INFO  [info] welcome to sbt 1.4.7 (Private Build Java 1.8.0_275)[0m
[0m2021.02.25 14:33:40 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project/project[0m
[0m2021.02.25 14:33:41 INFO  [info] loading settings for project ccrawlsapp-build-build-build from metals.sbt ...[0m
[0m2021.02.25 14:33:43 INFO  [info] loading settings for project ccrawlsapp-build-build from metals.sbt ...[0m
[0m2021.02.25 14:33:43 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project/project[0m
[0m2021.02.25 14:33:43 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project[0m
[0m2021.02.25 14:33:46 INFO  [info] loading settings for project ccrawlsapp-build-build from metals.sbt ...[0m
[0m2021.02.25 14:33:46 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project[0m
[0m2021.02.25 14:33:47 ERROR [info] waiting for lock on /home/cjen/.ivy2/exclude_classifiers.lock to be available...[0m
[0m2021.02.25 14:33:48 INFO  [success] Generated .bloop/ccrawlsapp-build-build.json[0m
[0m2021.02.25 14:33:48 INFO  [success] Total time: 4 s, completed Feb 25, 2021 2:33:48 PM[0m
[0m2021.02.25 14:33:49 INFO  [info] loading settings for project ccrawlsapp-build from metals.sbt,plugins.sbt ...[0m
[0m2021.02.25 14:33:49 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project[0m
[0m2021.02.25 14:33:49 ERROR [info] waiting for lock on /home/cjen/.ivy2/exclude_classifiers.lock to be available...[0m
[0m2021.02.25 14:33:52 INFO  [success] Generated .bloop/ccrawlsapp-build-build.json[0m
[0m2021.02.25 14:33:52 INFO  [success] Total time: 7 s, completed Feb 25, 2021 2:33:53 PM[0m
[0m2021.02.25 14:33:53 INFO  [success] Generated .bloop/ccrawlsapp-build.json[0m
[0m2021.02.25 14:33:54 INFO  [info] loading settings for project ccrawlsapp-build from metals.sbt,plugins.sbt ...[0m
[0m2021.02.25 14:33:54 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project[0m
[0m2021.02.25 14:33:55 INFO  [success] Total time: 6 s, completed Feb 25, 2021 2:33:55 PM[0m
[0m2021.02.25 14:33:56 INFO  [success] Generated .bloop/ccrawlsapp-build.json[0m
[0m2021.02.25 14:33:56 INFO  [info] loading settings for project root from build.sbt ...[0m
[0m2021.02.25 14:33:56 INFO  [info] set current project to ccrawlsapp (in build file:/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/)[0m
[0m2021.02.25 14:33:57 INFO  [success] Total time: 3 s, completed Feb 25, 2021 2:33:57 PM[0m
[0m2021.02.25 14:33:58 INFO  [info] loading settings for project root from build.sbt ...[0m
[0m2021.02.25 14:33:58 INFO  [info] set current project to ccrawlsapp (in build file:/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/)[0m
[0m2021.02.25 14:34:00 INFO  [success] Generated .bloop/root.json[0m
[0m2021.02.25 14:34:00 INFO  [success] Generated .bloop/root-test.json[0m
[0m2021.02.25 14:34:00 INFO  [success] Total time: 3 s, completed Feb 25, 2021 2:34:00 PM[0m
[0m2021.02.25 14:34:01 INFO  [success] Generated .bloop/root-test.json[0m
[0m2021.02.25 14:34:01 INFO  [success] Generated .bloop/root.json[0m
[0m2021.02.25 14:34:00 INFO  sbt bloopInstall exit: 0[0m
[0m2021.02.25 14:34:01 INFO  time: ran 'sbt bloopInstall' in 30s[0m
[0m2021.02.25 14:34:01 INFO  Disconnecting from Bloop session...[0m
[0m2021.02.25 14:34:01 INFO  [success] Total time: 2 s, completed Feb 25, 2021 2:34:01 PM[0m
[0m2021.02.25 14:34:01 INFO  Shut down connection with build server.[0m
[0m2021.02.25 14:34:01 INFO  Shut down connection with build server.[0m
No more data in the client stdin, exiting...
No more data in the client stdin, exiting...
[0m2021.02.25 14:34:01 INFO  Shut down connection with build server.[0m
No more data in the client stdin, exiting...
[0m2021.02.25 14:34:01 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher4213901846759783023/bsp.socket'...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
Waiting for the bsp connection to come up...
[0m2021.02.25 14:34:01 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 14:34:01 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 14:34:01 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 14:34:01 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 14:34:01 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 14:34:01 INFO  time: Connected to build server in 0.25s[0m
[0m2021.02.25 14:34:01 INFO  Connected to Build server: Bloop v1.4.8[0m
[0m2021.02.25 14:34:01 INFO  sbt bloopInstall exit: 0[0m
[0m2021.02.25 14:34:01 INFO  time: ran 'sbt bloopInstall' in 29s[0m
[0m2021.02.25 14:34:01 INFO  Disconnecting from Bloop session...[0m
[0m2021.02.25 14:34:01 INFO  Shut down connection with build server.[0m
[0m2021.02.25 14:34:01 INFO  Shut down connection with build server.[0m
[0m2021.02.25 14:34:01 INFO  Shut down connection with build server.[0m
[0m2021.02.25 14:34:01 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 14:34:01 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 14:34:01 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 14:34:01 INFO  Attempting to connect to the build server...[0m
[0m2021.02.25 14:34:01 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 14:34:01 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.25 14:34:01 INFO  time: Connected to build server in 0.17s[0m
[0m2021.02.25 14:34:01 INFO  Connected to Build server: Bloop v1.4.8[0m
[0m2021.02.25 14:34:01 INFO  time: Imported build in 0.13s[0m
[0m2021.02.25 14:34:04 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.25 14:34:04 INFO  time: indexed workspace in 2.58s[0m
[0m2021.02.25 14:34:04 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.25 14:34:04 INFO  time: indexed workspace in 2.61s[0m
[0m2021.02.25 14:34:53 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 14:34:54 INFO  time: compiled root in 1.06s[0m
[0m2021.02.25 14:35:25 INFO  time: code lens generation in 4.58s[0m
[0m2021.02.25 14:35:25 INFO  time: code lens generation in 6s[0m
[0m2021.02.25 17:01:07 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 17:01:09 INFO  time: compiled root in 2.46s[0m
[0m2021.02.25 17:01:32 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 17:01:32 INFO  time: compiled root in 0.7s[0m
[0m2021.02.25 17:01:44 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 17:01:44 INFO  time: compiled root in 0.82s[0m
[0m2021.02.25 17:01:51 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 17:01:52 INFO  time: compiled root in 1.38s[0m
[0m2021.02.25 17:16:31 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 17:16:31 INFO  time: compiled root in 0.92s[0m
[0m2021.02.25 17:22:03 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 17:22:03 INFO  time: compiled root in 0.7s[0m
[0m2021.02.25 20:05:22 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 20:05:24 INFO  time: compiled root in 1.36s[0m
[0m2021.02.25 20:05:31 INFO  compiling root (1 scala source)[0m
[0m2021.02.25 20:05:34 INFO  time: compiled root in 2.85s[0m
[0m2021.02.26 03:47:04 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 03:47:06 INFO  time: compiled root in 2.58s[0m
[0m2021.02.26 03:48:32 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 03:48:35 INFO  time: compiled root in 2.22s[0m
[0m2021.02.26 03:49:18 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 03:49:22 INFO  time: compiled root in 4.02s[0m
[0m2021.02.26 03:49:38 INFO  shutting down Metals[0m
[0m2021.02.26 03:49:38 INFO  Shut down connection with build server.[0m
[0m2021.02.26 03:49:38 INFO  Shut down connection with build server.[0m
[0m2021.02.26 03:49:38 INFO  Shut down connection with build server.[0m
[0m2021.02.26 03:53:52 INFO  Started: Metals version 0.10.0 in workspace '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp' for client vscode 1.53.2.[0m
[0m2021.02.26 03:53:52 INFO  time: initialize in 0.8s[0m
[0m2021.02.26 03:53:53 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
[0m2021.02.26 03:53:52 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala[0m
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher1941627582584581291/bsp.socket'...
Waiting for the bsp connection to come up...
[0m2021.02.26 03:53:54 INFO  skipping build import with status 'Installed'[0m
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
[0m2021.02.26 03:53:58 INFO  no build target: using presentation compiler with only scala-library: 2.12.13[0m
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
package com.revature.ccrawlsapp

import com.amazonaws.services.s3.AmazonS3Client
import com.amazonaws.auth.BasicAWSCredentials
import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.functions

object Runner {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession
      .builder()
      .config("spark.debug.maxToStringFields", 100)
      .appName("ccrawlsapp")
      .master("local[4]")
      .getOrCreate()

    // Reference: https://sparkbyexamples.com/spark/spark-read-text-file-from-s3/#s3-dependency
    val key = System.getenv(("AWS_ACCESS_KEY_ID"))
    val secret = System.getenv(("AWS_SECRET_ACCESS_KEY"))

    spark.sparkContext.hadoopConfiguration.set("fs.s3a.access.key", key)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.secret.key", secret)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.endpoint", "s3.amazonaws.com")
    
    import spark.implicits._
    spark.sparkContext.setLogLevel("WARN")

    val dfFromFile = spark.read.parquet("s3a://commoncrawl/cc-index/table/cc-main/warc/crawl=CC-MAIN-2021-04/subset=warc/part-00299-364a895c-5e5c-46bb-846e-75ec7de82b3b.c000.gz.parquet")
    dfFromFile.printSchema()

    dfFromFile.columns.take(2000).foreach(println)

    

  }
}
package com.revature.ccrawlsapp

import com.amazonaws.services.s3.AmazonS3Client
import com.amazonaws.auth.BasicAWSCredentials
import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.functions

object Runner {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession
      .builder()
      .config("spark.debug.maxToStringFields", 100)
      .appName("ccrawlsapp")
      .master("local[4]")
      .getOrCreate()

    // Reference: https://sparkbyexamples.com/spark/spark-read-text-file-from-s3/#s3-dependency
    val key = System.getenv(("AWS_ACCESS_KEY_ID"))
    val secret = System.getenv(("AWS_SECRET_ACCESS_KEY"))

    spark.sparkContext.hadoopConfiguration.set("fs.s3a.access.key", key)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.secret.key", secret)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.endpoint", "s3.amazonaws.com")
    
    import spark.implicits._
    spark.sparkContext.setLogLevel("WARN")

    val dfFromFile = spark.read.parquet("s3a://commoncrawl/cc-index/table/cc-main/warc/crawl=CC-MAIN-2021-04/subset=warc/part-00299-364a895c-5e5c-46bb-846e-75ec7de82b3b.c000.gz.parquet")
    dfFromFile.printSchema()

    dfFromFile.columns.take(2000).foreach(println)

    

  }
}
[0m2021.02.26 03:54:01 INFO  time: code lens generation in 7.7s[0m
Waiting for the bsp connection to come up...
No server running at 127.0.0.1:8212, let's fire one...
Resolving ch.epfl.scala:bloop-frontend_2.12:1.4.8...
Starting bloop server at 127.0.0.1:8212...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Loading 2 projects from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop'...
[0m[32m[D][0m Loading project from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop/root-test.json'
[0m[32m[D][0m Loading project from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop/root.json'
[0m[32m[D][0m Cache miss for scala instance org.scala-lang:scala-compiler:2.11.12.
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/jline/jline/2.14.3/jline-2.14.3.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/modules/scala-parser-combinators_2.11/1.0.4/scala-parser-combinators_2.11-1.0.4.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/modules/scala-xml_2.11/1.0.5/scala-xml_2.11-1.0.5.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-compiler/2.11.12/scala-compiler-2.11.12.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-library/2.11.12/scala-library-2.11.12.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-reflect/2.11.12/scala-reflect-2.11.12.jar
[0m[32m[D][0m Configured SemanticDB in projects 'root-test', 'root'
[0m[32m[D][0m Missing analysis file for project 'root-test'
[0m[32m[D][0m Loading previous analysis for 'root' from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/target/streams/compile/bloopAnalysisOut/_global/streams/inc_compile_2.11.zip'.
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher1941627582584581291/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher1941627582584581291/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.26 03:54:01 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.26 03:54:01 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher7253190752713004231/bsp.socket'...
[0m2021.02.26 03:54:01 INFO  Attempting to connect to the build server...[0m
Waiting for the bsp connection to come up...
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher1337437641893562077/bsp.socket'...
Waiting for the bsp connection to come up...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher7253190752713004231/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher7253190752713004231/bsp.socket...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher1337437641893562077/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher1337437641893562077/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.26 03:54:02 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.26 03:54:02 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.26 03:54:02 INFO  time: Connected to build server in 8.59s[0m
[0m2021.02.26 03:54:02 INFO  Connected to Build server: Bloop v1.4.8[0m
[0m2021.02.26 03:54:02 INFO  time: Imported build in 0.22s[0m
[0m2021.02.26 03:54:04 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.26 03:54:06 INFO  time: indexed workspace in 3.43s[0m
Feb 26, 2021 5:24:29 AM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 31
[0m2021.02.26 05:27:40 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 05:27:44 INFO  time: compiled root in 4.38s[0m
[0m2021.02.26 05:29:06 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 05:29:08 INFO  time: compiled root in 1.58s[0m
[0m2021.02.26 05:31:25 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 05:31:26 INFO  time: compiled root in 1.56s[0m
[0m2021.02.26 05:32:01 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 05:32:01 INFO  time: compiled root in 0.41s[0m
[0m2021.02.26 05:32:13 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:31: stale bloop error: value | is not a member of String
    .filter($"url_path".rlike("job"|"career"))
                              ^^^^^^[0m
[0m2021.02.26 05:32:13 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:31: stale bloop error: value | is not a member of String
    .filter($"url_path".rlike("job"|"career"))
                              ^^^^^^[0m
[0m2021.02.26 05:32:16 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 05:32:17 INFO  time: compiled root in 1.08s[0m
[0m2021.02.26 07:29:12 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 07:29:13 INFO  time: compiled root in 1s[0m
[0m2021.02.26 07:30:06 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 07:30:06 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:06 INFO  time: compiled root in 0.15s[0m
[0m2021.02.26 07:30:09 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:09 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:09 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:10 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:11 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:11 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:13 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:13 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:13 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:13 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:36: stale bloop error: unclosed character literal
    .filter($"url_path" like '%job%')
                                   ^[0m
[0m2021.02.26 07:30:15 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 07:30:16 INFO  time: compiled root in 1.09s[0m
[0m2021.02.26 07:39:54 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 07:39:54 INFO  time: compiled root in 0.9s[0m
[0m2021.02.26 07:40:13 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 07:40:13 INFO  time: compiled root in 0.22s[0m
[0m2021.02.26 07:40:46 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:13: stale bloop error: value OR is not a member of org.apache.spark.sql.Column
    .filter($"url_path" like "%job%" OR $"url_path" like "%career%")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 07:40:46 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:13: stale bloop error: value OR is not a member of org.apache.spark.sql.Column
    .filter($"url_path" like "%job%" OR $"url_path" like "%career%")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 07:40:46 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:13: stale bloop error: value OR is not a member of org.apache.spark.sql.Column
    .filter($"url_path" like "%job%" OR $"url_path" like "%career%")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 07:40:46 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:13: stale bloop error: value OR is not a member of org.apache.spark.sql.Column
    .filter($"url_path" like "%job%" OR $"url_path" like "%career%")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 07:40:47 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:13: stale bloop error: value OR is not a member of org.apache.spark.sql.Column
    .filter($"url_path" like "%job%" OR $"url_path" like "%career%")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 07:40:47 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:13: stale bloop error: value OR is not a member of org.apache.spark.sql.Column
    .filter($"url_path" like "%job%" OR $"url_path" like "%career%")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 07:40:50 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:13: stale bloop error: value OR is not a member of org.apache.spark.sql.Column
    .filter($"url_path" like "%job%" OR $"url_path" like "%career%")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 07:40:50 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:13: stale bloop error: value OR is not a member of org.apache.spark.sql.Column
    .filter($"url_path" like "%job%" OR $"url_path" like "%career%")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 07:40:51 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:13: stale bloop error: value OR is not a member of org.apache.spark.sql.Column
    .filter($"url_path" like "%job%" OR $"url_path" like "%career%")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 07:40:51 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:38:13: stale bloop error: value OR is not a member of org.apache.spark.sql.Column
    .filter($"url_path" like "%job%" OR $"url_path" like "%career%")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 07:41:04 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 07:41:04 INFO  time: compiled root in 0.15s[0m
[0m2021.02.26 07:41:10 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 07:41:10 INFO  time: compiled root in 0.82s[0m
[0m2021.02.26 07:50:01 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 07:50:01 INFO  time: compiled root in 0.75s[0m
[0m2021.02.26 07:53:26 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 07:53:26 INFO  time: compiled root in 0.72s[0m
[0m2021.02.26 08:04:11 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 08:04:11 INFO  time: compiled root in 0.71s[0m
[0m2021.02.26 08:13:37 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 08:13:38 INFO  time: compiled root in 1.01s[0m
something's wrong: no file:///home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala in Array[String]RangePosition(file:///home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala, 240, 240, 253)
[0m2021.02.26 09:42:54 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 09:42:54 INFO  time: compiled root in 0.72s[0m
[0m2021.02.26 09:43:04 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 09:43:04 INFO  time: compiled root in 0.67s[0m
[0m2021.02.26 09:44:09 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 09:44:09 INFO  time: compiled root in 0.87s[0m
[0m2021.02.26 09:51:47 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 09:51:47 INFO  time: compiled root in 0.68s[0m
[0m2021.02.26 09:52:16 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 09:52:16 INFO  time: compiled root in 0.66s[0m
[0m2021.02.26 10:01:43 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 10:01:43 INFO  time: compiled root in 0.63s[0m
[0m2021.02.26 16:50:50 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 16:50:50 INFO  time: compiled root in 0.83s[0m
[0m2021.02.26 17:23:52 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:23:52 INFO  time: compiled root in 0.65s[0m
[0m2021.02.26 17:24:09 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:24:09 INFO  time: compiled root in 0.65s[0m
[0m2021.02.26 17:25:49 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:25:49 INFO  time: compiled root in 0.7s[0m
[0m2021.02.26 17:32:16 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:32:16 INFO  time: compiled root in 0.68s[0m
[0m2021.02.26 17:38:34 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:38:34 INFO  time: compiled root in 0.17s[0m
[0m2021.02.26 17:41:42 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:41:42 INFO  time: compiled root in 0.16s[0m
[0m2021.02.26 17:41:56 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:41:56 INFO  time: compiled root in 0.7s[0m
[0m2021.02.26 17:42:11 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:42:11 INFO  time: compiled root in 0.17s[0m
[0m2021.02.26 17:44:02 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:44:02 INFO  time: compiled root in 0.11s[0m
[0m2021.02.26 17:44:30 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:44:30 INFO  time: compiled root in 0.98s[0m
[0m2021.02.26 17:48:58 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:48:58 INFO  time: compiled root in 0.67s[0m
[0m2021.02.26 17:49:15 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:49:15 INFO  time: compiled root in 0.75s[0m
[0m2021.02.26 17:54:38 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:54:38 INFO  time: compiled root in 0.72s[0m
[0m2021.02.26 17:54:45 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 17:54:45 INFO  time: compiled root in 0.68s[0m
[0m2021.02.26 18:02:05 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:02:05 INFO  time: compiled root in 0.64s[0m
[0m2021.02.26 18:02:33 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:02:33 INFO  time: compiled root in 0.71s[0m
Feb 26, 2021 6:08:16 PM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint fallbackResponseError
SEVERE: Internal error: java.lang.IllegalArgumentException: 96 is not a valid line number, allowed [0..55]
java.util.concurrent.CompletionException: java.lang.IllegalArgumentException: 96 is not a valid line number, allowed [0..55]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at scala.meta.internal.metals.CancelTokens$.$anonfun$future$1(CancelTokens.scala:40)
	at scala.meta.internal.metals.CancelTokens$.$anonfun$future$1$adapted(CancelTokens.scala:38)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalArgumentException: 96 is not a valid line number, allowed [0..55]
	at scala.meta.internal.inputs.InternalInput.lineToOffset(InternalInput.scala:38)
	at scala.meta.internal.inputs.InternalInput.lineToOffset$(InternalInput.scala:33)
	at scala.meta.inputs.Input$VirtualFile.lineToOffset(Input.scala:80)
	at scala.meta.inputs.Position$Range$.apply(Position.scala:59)
	at scala.meta.internal.mtags.CommonMtagsEnrichments$XtensionLspRange.toMeta(CommonMtagsEnrichments.scala:183)
	at scala.meta.internal.metals.codeactions.InsertInferredType.$anonfun$contribute$5(InsertInferredType.scala:85)
	at scala.Option.map(Option.scala:230)
	at scala.meta.internal.metals.codeactions.InsertInferredType.$anonfun$contribute$1(InsertInferredType.scala:84)
	at scala.concurrent.Future$.$anonfun$apply$1(Future.scala:659)
	at scala.util.Success.$anonfun$map$1(Try.scala:255)
	at scala.util.Success.map(Try.scala:213)
	at scala.concurrent.Future.$anonfun$map$1(Future.scala:292)
	at scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:33)
	at scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:33)
	... 4 more

Feb 26, 2021 6:08:34 PM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint fallbackResponseError
SEVERE: Internal error: java.lang.IllegalArgumentException: 97 is not a valid line number, allowed [0..55]
java.util.concurrent.CompletionException: java.lang.IllegalArgumentException: 97 is not a valid line number, allowed [0..55]
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:292)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:308)
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:661)
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:646)
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488)
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990)
	at scala.meta.internal.metals.CancelTokens$.$anonfun$future$1(CancelTokens.scala:40)
	at scala.meta.internal.metals.CancelTokens$.$anonfun$future$1$adapted(CancelTokens.scala:38)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalArgumentException: 97 is not a valid line number, allowed [0..55]
	at scala.meta.internal.inputs.InternalInput.lineToOffset(InternalInput.scala:38)
	at scala.meta.internal.inputs.InternalInput.lineToOffset$(InternalInput.scala:33)
	at scala.meta.inputs.Input$VirtualFile.lineToOffset(Input.scala:80)
	at scala.meta.inputs.Position$Range$.apply(Position.scala:59)
	at scala.meta.internal.mtags.CommonMtagsEnrichments$XtensionLspRange.toMeta(CommonMtagsEnrichments.scala:183)
	at scala.meta.internal.metals.codeactions.InsertInferredType.$anonfun$contribute$5(InsertInferredType.scala:85)
	at scala.Option.map(Option.scala:230)
	at scala.meta.internal.metals.codeactions.InsertInferredType.$anonfun$contribute$1(InsertInferredType.scala:84)
	at scala.concurrent.Future$.$anonfun$apply$1(Future.scala:659)
	at scala.util.Success.$anonfun$map$1(Try.scala:255)
	at scala.util.Success.map(Try.scala:213)
	at scala.concurrent.Future.$anonfun$map$1(Future.scala:292)
	at scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:33)
	at scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:33)
	... 4 more

[0m2021.02.26 18:14:35 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:14:35 INFO  time: compiled root in 0.82s[0m
[0m2021.02.26 18:17:34 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:17:34 INFO  time: compiled root in 0.74s[0m
[0m2021.02.26 18:18:05 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:18:05 INFO  time: compiled root in 0.69s[0m
[0m2021.02.26 18:20:44 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:20:44 INFO  time: compiled root in 0.85s[0m
[0m2021.02.26 18:23:27 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:23:27 INFO  time: compiled root in 0.78s[0m
[0m2021.02.26 18:25:19 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:25:19 INFO  time: compiled root in 0.17s[0m
[0m2021.02.26 18:27:33 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:27:33 INFO  time: compiled root in 0.76s[0m
[0m2021.02.26 18:31:21 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:31:21 INFO  time: compiled root in 0.15s[0m
[0m2021.02.26 18:31:29 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:31:29 INFO  time: compiled root in 0.11s[0m
[0m2021.02.26 18:32:16 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:32:16 INFO  time: compiled root in 0.11s[0m
[0m2021.02.26 18:32:58 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:32:58 INFO  time: compiled root in 0.12s[0m
[0m2021.02.26 18:33:15 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:33:15 INFO  time: compiled root in 0.71s[0m
[0m2021.02.26 18:34:36 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:34:36 INFO  time: compiled root in 0.17s[0m
[0m2021.02.26 18:35:22 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:35:22 INFO  time: compiled root in 0.16s[0m
[0m2021.02.26 18:35:38 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:35:38 INFO  time: compiled root in 0.21s[0m
[0m2021.02.26 18:37:06 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:37:06 INFO  time: compiled root in 0.71s[0m
[0m2021.02.26 18:37:52 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:37:52 INFO  time: compiled root in 0.16s[0m
[0m2021.02.26 18:38:55 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:38:55 INFO  time: compiled root in 0.75s[0m
[0m2021.02.26 18:44:49 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 18:44:49 INFO  time: compiled root in 0.83s[0m
[0m2021.02.26 19:03:25 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:03:25 INFO  time: compiled root in 0.71s[0m
[0m2021.02.26 19:05:35 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:05:36 INFO  time: compiled root in 1s[0m
[0m2021.02.26 19:05:44 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:05:44 INFO  time: compiled root in 0.71s[0m
[0m2021.02.26 19:14:47 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:14:47 INFO  time: compiled root in 0.71s[0m
[0m2021.02.26 19:14:58 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:14:58 INFO  time: compiled root in 0.65s[0m
[0m2021.02.26 19:28:32 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:28:32 INFO  time: compiled root in 0.38s[0m
[0m2021.02.26 19:32:38 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:32:38 INFO  time: compiled root in 0.83s[0m
[0m2021.02.26 19:32:48 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:32:48 INFO  time: compiled root in 0.7s[0m
[0m2021.02.26 19:33:31 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:33:31 INFO  time: compiled root in 0.7s[0m
[0m2021.02.26 19:38:57 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:38:57 INFO  time: compiled root in 0.18s[0m
[0m2021.02.26 19:45:04 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:45:04 INFO  time: compiled root in 0.16s[0m
[0m2021.02.26 19:45:35 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:45:35 INFO  time: compiled root in 0.19s[0m
[0m2021.02.26 19:47:20 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:47:20 INFO  time: compiled root in 0.16s[0m
[0m2021.02.26 19:48:27 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:48:27 INFO  time: compiled root in 0.16s[0m
[0m2021.02.26 19:49:01 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:49:01 INFO  time: compiled root in 0.18s[0m
[0m2021.02.26 19:49:21 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:49:21 INFO  time: compiled root in 0.16s[0m
[0m2021.02.26 19:52:17 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:52:17 INFO  time: compiled root in 0.15s[0m
[0m2021.02.26 19:52:28 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:52:28 INFO  time: compiled root in 0.68s[0m
[0m2021.02.26 19:53:41 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:53:41 INFO  time: compiled root in 0.65s[0m
[0m2021.02.26 19:53:49 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:53:49 INFO  time: compiled root in 0.7s[0m
[0m2021.02.26 19:58:23 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:58:23 INFO  time: compiled root in 0.62s[0m
[0m2021.02.26 19:59:23 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 19:59:23 INFO  time: compiled root in 0.18s[0m
[0m2021.02.26 20:00:41 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:118:37: stale bloop error: value newColumn is not a member of org.apache.spark.sql.Row
    dfSelectedFromFile.map(x => (x, x.newColumn)).toDF("url_host", "url_path")
                                    ^^^^^^^^^^^[0m
[0m2021.02.26 20:00:41 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:118:37: stale bloop error: value newColumn is not a member of org.apache.spark.sql.Row
    dfSelectedFromFile.map(x => (x, x.newColumn)).toDF("url_host", "url_path")
                                    ^^^^^^^^^^^[0m
[0m2021.02.26 20:00:41 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:118:37: stale bloop error: value newColumn is not a member of org.apache.spark.sql.Row
    dfSelectedFromFile.map(x => (x, x.newColumn)).toDF("url_host", "url_path")
                                    ^^^^^^^^^^^[0m
[0m2021.02.26 20:00:42 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:118:37: stale bloop error: value newColumn is not a member of org.apache.spark.sql.Row
    dfSelectedFromFile.map(x => (x, x.newColumn)).toDF("url_host", "url_path")
                                    ^^^^^^^^^^^[0m
[0m2021.02.26 20:00:42 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:118:37: stale bloop error: value newColumn is not a member of org.apache.spark.sql.Row
    dfSelectedFromFile.map(x => (x, x.newColumn)).toDF("url_host", "url_path")
                                    ^^^^^^^^^^^[0m
[0m2021.02.26 20:00:42 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:118:37: stale bloop error: value newColumn is not a member of org.apache.spark.sql.Row
    dfSelectedFromFile.map(x => (x, x.newColumn)).toDF("url_host", "url_path")
                                    ^^^^^^^^^^^[0m
[0m2021.02.26 20:03:32 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:03:32 INFO  time: compiled root in 0.17s[0m
[0m2021.02.26 20:03:40 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:03:40 INFO  time: compiled root in 0.79s[0m
[0m2021.02.26 20:03:55 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:03:55 INFO  time: compiled root in 0.75s[0m
[0m2021.02.26 20:12:32 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:12:32 INFO  time: compiled root in 0.74s[0m
[0m2021.02.26 20:12:41 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:12:41 INFO  time: compiled root in 0.68s[0m
[0m2021.02.26 20:14:46 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:14:46 INFO  time: compiled root in 0.73s[0m
Feb 26, 2021 8:14:54 PM org.eclipse.lsp4j.jsonrpc.RemoteEndpoint handleCancellation
WARNING: Unmatched cancel notification for request id 6955
[0m2021.02.26 20:30:31 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:30:31 INFO  time: compiled root in 0.19s[0m
[0m2021.02.26 20:30:45 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:30:45 INFO  time: compiled root in 0.16s[0m
[0m2021.02.26 20:30:56 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:120:5: stale bloop error: overloaded method value show with alternatives:
  (numRows: Int,truncate: Int)Unit <and>
  (numRows: Int,truncate: Boolean)Unit
 cannot be applied to (String, Boolean)
    dfSelectedFromFile.show(args(1), false)
    ^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 20:30:56 INFO  /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala:120:5: stale bloop error: overloaded method value show with alternatives:
  (numRows: Int,truncate: Int)Unit <and>
  (numRows: Int,truncate: Boolean)Unit
 cannot be applied to (String, Boolean)
    dfSelectedFromFile.show(args(1), false)
    ^^^^^^^^^^^^^^^^^^^^^^^[0m
[0m2021.02.26 20:31:41 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:31:41 INFO  time: compiled root in 0.18s[0m
[0m2021.02.26 20:32:05 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:32:05 INFO  time: compiled root in 0.16s[0m
[0m2021.02.26 20:32:19 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:32:19 INFO  time: compiled root in 0.17s[0m
[0m2021.02.26 20:33:05 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:33:05 INFO  time: compiled root in 0.77s[0m
[0m2021.02.26 20:37:46 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:37:46 INFO  time: compiled root in 0.2s[0m
[0m2021.02.26 20:38:10 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:38:10 INFO  time: compiled root in 0.74s[0m
[0m2021.02.26 20:38:43 INFO  compiling root (1 scala source)[0m
[0m2021.02.26 20:38:43 INFO  time: compiled root in 0.74s[0m
[0m2021.02.27 04:30:39 INFO  compiling root (1 scala source)[0m
[0m2021.02.27 04:30:39 INFO  time: compiled root in 0.84s[0m
[0m2021.02.27 04:33:50 INFO  compiling root (1 scala source)[0m
[0m2021.02.27 04:33:50 INFO  time: compiled root in 0.8s[0m
[0m2021.02.27 04:41:51 INFO  compiling root (1 scala source)[0m
[0m2021.02.27 04:41:52 INFO  time: compiled root in 1.09s[0m
[0m2021.02.27 04:54:13 INFO  compiling root (1 scala source)[0m
[0m2021.02.27 04:54:13 INFO  time: compiled root in 0.77s[0m
[0m2021.02.27 14:27:40 INFO  compiling root (1 scala source)[0m
[0m2021.02.27 14:27:40 INFO  time: compiled root in 0.71s[0m
[0m2021.02.27 14:57:42 INFO  shutting down Metals[0m
[0m2021.02.27 14:57:42 INFO  Shut down connection with build server.[0m
No more data in the client stdin, exiting...
[0m2021.02.27 14:57:42 INFO  Shut down connection with build server.[0m
No more data in the client stdin, exiting...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
[0m2021.02.27 14:57:42 INFO  Shut down connection with build server.[0m
No more data in the client stdin, exiting...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
[0m2021.02.27 15:03:49 INFO  Started: Metals version 0.10.0 in workspace '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp' for client vscode 1.53.2.[0m
[0m2021.02.27 15:03:49 INFO  time: initialize in 0.59s[0m
[0m2021.02.27 15:03:50 INFO  Attempting to connect to the build server...[0m
[0m2021.02.27 15:03:50 WARN  no build target for: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/scala/com/revature/ccrawlsapp/Runner.scala[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher693681396999398900/bsp.socket'...
Waiting for the bsp connection to come up...
[0m2021.02.27 15:03:51 INFO  skipping build import with status 'Installed'[0m
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
[0m2021.02.27 15:03:54 INFO  no build target: using presentation compiler with only scala-library: 2.12.13[0m
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
package com.revature.ccrawlsapp

import com.amazonaws.services.s3.AmazonS3Client
import com.amazonaws.auth.BasicAWSCredentials
import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.functions
import org.apache.spark.sql.SaveMode
import org.apache.spark.SparkContext

object Runner {
  def main(args: Array[String]): Unit = {

    if(args.length != 2) {
      println("please specify: `yyyy-mm` [e.g. 2020-16] `Nrows` [e.g. 2000] ")
      System.exit(1)
    }

    val spark = SparkSession
      .builder()
      .config("spark.debug.maxToStringFields", 100)
      .appName("ccrawlsapp")
      .master("local[4]")
      .getOrCreate()

    // Reference: https://sparkbyexamples.com/spark/spark-read-text-file-from-s3/#s3-dependency
    val key = System.getenv(("AWS_ACCESS_KEY_ID"))
    val secret = System.getenv(("AWS_SECRET_ACCESS_KEY"))

    spark.sparkContext.hadoopConfiguration.set("fs.s3a.access.key", key)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.secret.key", secret)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.endpoint", "s3.amazonaws.com")
    
    import spark.implicits._
    spark.sparkContext.setLogLevel("WARN")

    /*val dfExpFromFile = spark.read.parquet("s3a://commoncrawl/cc-index/table/cc-main/warc/crawl=CC-MAIN-2021-04/subset=warc/part-00299-364a895c-5e5c-46bb-846e-75ec7de82b3b.c000.gz.parquet")
    dfExpFromFile.printSchema()
    dfExpFromFile.columns.take(2000).foreach(println)*/
/*
root
 |-- url_surtkey: string (nullable = true)
 |-- url: string (nullable = true)
 |-- url_host_name: string (nullable = true)
 |-- url_host_tld: string (nullable = true)
 |-- url_host_2nd_last_part: string (nullable = true)
 |-- url_host_3rd_last_part: string (nullable = true)
 |-- url_host_4th_last_part: string (nullable = true)
 |-- url_host_5th_last_part: string (nullable = true)
 |-- url_host_registry_suffix: string (nullable = true)
 |-- url_host_registered_domain: string (nullable = true)
 |-- url_host_private_suffix: string (nullable = true)
 |-- url_host_private_domain: string (nullable = true)
 |-- url_protocol: string (nullable = true)
 |-- url_port: integer (nullable = true)
 |-- url_path: string (nullable = true)
 |-- url_query: string (nullable = true)
 |-- fetch_time: timestamp (nullable = true)
 |-- fetch_status: short (nullable = true)
 |-- fetch_redirect: string (nullable = true)
 |-- content_digest: string (nullable = true)
 |-- content_mime_type: string (nullable = true)
 |-- content_mime_detected: string (nullable = true)
 |-- content_charset: string (nullable = true)
 |-- content_languages: string (nullable = true)
 |-- content_truncated: string (nullable = true)
 |-- warc_filename: string (nullable = true)
 |-- warc_record_offset: integer (nullable = true)
 |-- warc_record_length: integer (nullable = true)
 |-- warc_segment: string (nullable = true)

url_surtkey
url
url_host_name
url_host_tld
url_host_2nd_last_part
url_host_3rd_last_part
url_host_4th_last_part
url_host_5th_last_part
url_host_registry_suffix
url_host_registered_domain
url_host_private_suffix
url_host_private_domain
url_protocol
url_port
url_path
url_query
fetch_time
fetch_status
fetch_redirect
content_digest
content_mime_type
content_mime_detected
content_charset
content_languages
content_truncated
warc_filename
warc_record_offset
warc_record_length
warc_segment
*/
    val dfFromFile = spark.read.load("s3a://commoncrawl/cc-index/table/cc-main/warc/")

    /*val dfSelectedFromFile = dfFromFile
    .select("url_surtkey", "url", "url_host_name", "url_host_registry_suffix", "url_host_registered_domain", 
    "url_host_private_suffix", "url_host_private_domain", "url_protocol", "url_port", "url_path", "url_query", 
    "fetch_time", "fetch_status", "content_digest", "content_mime_type", "content_mime_detected", "warc_filename", 
    "warc_record_offset", "warc_record_length", "warc_segment")
    .filter($"crawl" === "CC-MAIN-"+args(0))
    .filter($"subset" === "warc")
    .filter($"url_path".rlike("job") || $"url_path".rlike("career"))*/

    val dfSelectedFromFile = dfFromFile
    .select("url", "url_host_name", "url_path", "warc_filename")
    .filter($"crawl" === "CC-MAIN-"+args(0))
    .filter($"subset" === "warc")
    .filter($"url_path".rlike("job") || $"url_path".rlike("career"))

    //dfSelectedFromFile.take(50000).foreach(println)
    
    val n = args(1)

    dfSelectedFromFile.show(n.toInt, false)

    dfSelectedFromFile.explain(true)

    println(dfSelectedFromFile.rdd.toDebugString)

  }
}
package com.revature.ccrawlsapp

import com.amazonaws.services.s3.AmazonS3Client
import com.amazonaws.auth.BasicAWSCredentials
import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.functions
import org.apache.spark.sql.SaveMode
import org.apache.spark.SparkContext

object Runner {
  def main(args: Array[String]): Unit = {

    if(args.length != 2) {
      println("please specify: `yyyy-mm` [e.g. 2020-16] `Nrows` [e.g. 2000] ")
      System.exit(1)
    }

    val spark = SparkSession
      .builder()
      .config("spark.debug.maxToStringFields", 100)
      .appName("ccrawlsapp")
      .master("local[4]")
      .getOrCreate()

    // Reference: https://sparkbyexamples.com/spark/spark-read-text-file-from-s3/#s3-dependency
    val key = System.getenv(("AWS_ACCESS_KEY_ID"))
    val secret = System.getenv(("AWS_SECRET_ACCESS_KEY"))

    spark.sparkContext.hadoopConfiguration.set("fs.s3a.access.key", key)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.secret.key", secret)
    spark.sparkContext.hadoopConfiguration.set("fs.s3a.endpoint", "s3.amazonaws.com")
    
    import spark.implicits._
    spark.sparkContext.setLogLevel("WARN")

    /*val dfExpFromFile = spark.read.parquet("s3a://commoncrawl/cc-index/table/cc-main/warc/crawl=CC-MAIN-2021-04/subset=warc/part-00299-364a895c-5e5c-46bb-846e-75ec7de82b3b.c000.gz.parquet")
    dfExpFromFile.printSchema()
    dfExpFromFile.columns.take(2000).foreach(println)*/
/*
root
 |-- url_surtkey: string (nullable = true)
 |-- url: string (nullable = true)
 |-- url_host_name: string (nullable = true)
 |-- url_host_tld: string (nullable = true)
 |-- url_host_2nd_last_part: string (nullable = true)
 |-- url_host_3rd_last_part: string (nullable = true)
 |-- url_host_4th_last_part: string (nullable = true)
 |-- url_host_5th_last_part: string (nullable = true)
 |-- url_host_registry_suffix: string (nullable = true)
 |-- url_host_registered_domain: string (nullable = true)
 |-- url_host_private_suffix: string (nullable = true)
 |-- url_host_private_domain: string (nullable = true)
 |-- url_protocol: string (nullable = true)
 |-- url_port: integer (nullable = true)
 |-- url_path: string (nullable = true)
 |-- url_query: string (nullable = true)
 |-- fetch_time: timestamp (nullable = true)
 |-- fetch_status: short (nullable = true)
 |-- fetch_redirect: string (nullable = true)
 |-- content_digest: string (nullable = true)
 |-- content_mime_type: string (nullable = true)
 |-- content_mime_detected: string (nullable = true)
 |-- content_charset: string (nullable = true)
 |-- content_languages: string (nullable = true)
 |-- content_truncated: string (nullable = true)
 |-- warc_filename: string (nullable = true)
 |-- warc_record_offset: integer (nullable = true)
 |-- warc_record_length: integer (nullable = true)
 |-- warc_segment: string (nullable = true)

url_surtkey
url
url_host_name
url_host_tld
url_host_2nd_last_part
url_host_3rd_last_part
url_host_4th_last_part
url_host_5th_last_part
url_host_registry_suffix
url_host_registered_domain
url_host_private_suffix
url_host_private_domain
url_protocol
url_port
url_path
url_query
fetch_time
fetch_status
fetch_redirect
content_digest
content_mime_type
content_mime_detected
content_charset
content_languages
content_truncated
warc_filename
warc_record_offset
warc_record_length
warc_segment
*/
    val dfFromFile = spark.read.load("s3a://commoncrawl/cc-index/table/cc-main/warc/")

    /*val dfSelectedFromFile = dfFromFile
    .select("url_surtkey", "url", "url_host_name", "url_host_registry_suffix", "url_host_registered_domain", 
    "url_host_private_suffix", "url_host_private_domain", "url_protocol", "url_port", "url_path", "url_query", 
    "fetch_time", "fetch_status", "content_digest", "content_mime_type", "content_mime_detected", "warc_filename", 
    "warc_record_offset", "warc_record_length", "warc_segment")
    .filter($"crawl" === "CC-MAIN-"+args(0))
    .filter($"subset" === "warc")
    .filter($"url_path".rlike("job") || $"url_path".rlike("career"))*/

    val dfSelectedFromFile = dfFromFile
    .select("url", "url_host_name", "url_path", "warc_filename")
    .filter($"crawl" === "CC-MAIN-"+args(0))
    .filter($"subset" === "warc")
    .filter($"url_path".rlike("job") || $"url_path".rlike("career"))

    //dfSelectedFromFile.take(50000).foreach(println)
    
    val n = args(1)

    dfSelectedFromFile.show(n.toInt, false)

    dfSelectedFromFile.explain(true)

    println(dfSelectedFromFile.rdd.toDebugString)

  }
}
[0m2021.02.27 15:03:56 INFO  time: code lens generation in 5.19s[0m
Waiting for the bsp connection to come up...
No server running at 127.0.0.1:8212, let's fire one...
Resolving ch.epfl.scala:bloop-frontend_2.12:1.4.8...
Starting bloop server at 127.0.0.1:8212...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Loading 2 projects from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop'...
[0m[32m[D][0m Loading project from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop/root.json'
[0m[32m[D][0m Loading project from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop/root-test.json'
[0m[32m[D][0m Cache miss for scala instance org.scala-lang:scala-compiler:2.11.12.
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/jline/jline/2.14.3/jline-2.14.3.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/modules/scala-parser-combinators_2.11/1.0.4/scala-parser-combinators_2.11-1.0.4.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/modules/scala-xml_2.11/1.0.5/scala-xml_2.11-1.0.5.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-compiler/2.11.12/scala-compiler-2.11.12.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-library/2.11.12/scala-library-2.11.12.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-reflect/2.11.12/scala-reflect-2.11.12.jar
[0m[32m[D][0m Configured SemanticDB in projects 'root-test', 'root'
[0m[32m[D][0m Missing analysis file for project 'root-test'
[0m[32m[D][0m Loading previous analysis for 'root' from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/target/streams/compile/bloopAnalysisOut/_global/streams/inc_compile_2.11.zip'.
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher693681396999398900/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher693681396999398900/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.27 15:03:56 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.27 15:03:56 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher2937614948225238920/bsp.socket'...[0m
2021.02.27 15:03:56 INFO  Attempting to connect to the build server...[0m
Waiting for the bsp connection to come up...
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher7881432072417723453/bsp.socket'...
Waiting for the bsp connection to come up...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher2937614948225238920/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher2937614948225238920/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.27 15:03:57 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher7881432072417723453/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher7881432072417723453/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.27 15:03:57 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.27 15:03:57 INFO  time: Connected to build server in 6.36s[0m
[0m2021.02.27 15:03:57 INFO  Connected to Build server: Bloop v1.4.8[0m
[0m2021.02.27 15:03:57 INFO  time: Imported build in 0.22s[0m
[0m2021.02.27 15:03:59 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.27 15:03:59 INFO  time: indexed workspace in 2.62s[0m
[0m2021.02.27 15:04:46 INFO  running '/usr/lib/jvm/java-8-openjdk-amd64/bin/java -Djline.terminal=jline.UnsupportedTerminal -Dsbt.log.noformat=true -Dfile.encoding=UTF-8 -jar /tmp/metals5889766491656019679/sbt-launch.jar -Dbloop.export-jar-classifiers=sources bloopInstall'[0m
[0m2021.02.27 15:04:48 INFO  [info] welcome to sbt 1.4.7 (Private Build Java 1.8.0_265)[0m
[0m2021.02.27 15:04:49 INFO  [info] loading settings for project ccrawlsapp-build-build-build from metals.sbt ...[0m
[0m2021.02.27 15:04:49 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project/project[0m
[0m2021.02.27 15:04:51 INFO  [info] loading settings for project ccrawlsapp-build-build from metals.sbt ...[0m
[0m2021.02.27 15:04:51 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project/project[0m
[0m2021.02.27 15:04:55 INFO  [success] Generated .bloop/ccrawlsapp-build-build.json[0m
[0m2021.02.27 15:04:55 INFO  [success] Total time: 4 s, completed Feb 27, 2021 3:04:55 PM[0m
[0m2021.02.27 15:04:55 INFO  [info] loading settings for project ccrawlsapp-build from metals.sbt,plugins.sbt ...[0m
[0m2021.02.27 15:04:55 INFO  [info] loading project definition from /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/project[0m
[0m2021.02.27 15:04:56 INFO  [success] Generated .bloop/ccrawlsapp-build.json[0m
[0m2021.02.27 15:04:56 INFO  [success] Total time: 1 s, completed Feb 27, 2021 3:04:57 PM[0m
[0m2021.02.27 15:04:57 INFO  [info] loading settings for project root from build.sbt ...[0m
[0m2021.02.27 15:04:57 INFO  [info] set current project to ccrawlsapp (in build file:/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/)[0m
[0m2021.02.27 15:04:58 INFO  [success] Generated .bloop/root-test.json[0m
[0m2021.02.27 15:04:58 INFO  [success] Generated .bloop/root.json[0m
[0m2021.02.27 15:04:58 INFO  [success] Total time: 1 s, completed Feb 27, 2021 3:04:58 PM[0m
[0m2021.02.27 15:04:58 INFO  sbt bloopInstall exit: 0[0m
[0m2021.02.27 15:04:59 INFO  time: ran 'sbt bloopInstall' in 12s[0m
[0m2021.02.27 15:04:59 INFO  Disconnecting from Bloop session...[0m
[0m2021.02.27 15:04:59 INFO  Shut down connection with build server.[0m
No more data in the client stdin, exiting...
[0m2021.02.27 15:04:59 INFO  Shut down connection with build server.[0m
[0m2021.02.27 15:04:59 INFO  Shut down connection with build server.[0m
No more data in the client stdin, exiting...
No more data in the client stdin, exiting...
[0m2021.02.27 15:04:59 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher4742597375892543358/bsp.socket'...
Waiting for the bsp connection to come up...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher4742597375892543358/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher4742597375892543358/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.27 15:04:59 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.27 15:04:59 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher3599818442874605258/bsp.socket'...
[0m2021.02.27 15:04:59 INFO  Attempting to connect to the build server...[0m
Waiting for the bsp connection to come up...
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher7476894445226386215/bsp.socket'...
Waiting for the bsp connection to come up...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher3599818442874605258/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher3599818442874605258/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.27 15:04:59 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher7476894445226386215/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher7476894445226386215/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.02.27 15:04:59 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.02.27 15:04:59 INFO  time: Connected to build server in 0.12s[0m
[0m2021.02.27 15:04:59 INFO  Connected to Build server: Bloop v1.4.8[0m
Caught unexpected io exception handling event for /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/java
java.nio.file.NoSuchFileException: /home/cjen/210104-usf-bigdata/week8/ccrawlsapp/src/main/java
	at com.swoval.files.NativeDirectoryLister.fillResults(NativeDirectoryLister.java:93)
	at com.swoval.files.NativeDirectoryLister.apply(NativeDirectoryLister.java:48)
	at com.swoval.files.SimpleFileTreeView$Lister.impl(SimpleFileTreeView.java:149)
	at com.swoval.files.SimpleFileTreeView$Lister.fillResults(SimpleFileTreeView.java:140)
	at com.swoval.files.SimpleFileTreeView.list(SimpleFileTreeView.java:50)
	at com.swoval.files.CachedDirectoryImpl.init(CachedDirectoryImpl.java:568)
	at com.swoval.files.CachedDirectoryImpl.init(CachedDirectoryImpl.java:557)
	at com.swoval.files.FileCacheDirectoryTree.newCachedDirectory(FileCacheDirectoryTree.java:623)
	at com.swoval.files.FileCacheDirectoryTree.handleEvent(FileCacheDirectoryTree.java:298)
	at com.swoval.files.FileTreeRepositories$1.onNext(FileTreeRepositories.java:79)
	at com.swoval.files.FileTreeRepositories$1.onNext(FileTreeRepositories.java:73)
	at com.swoval.files.Observers.onNext(Observers.java:31)
	at com.swoval.files.NioPathWatcher.runCallbacks(NioPathWatcher.java:423)
	at com.swoval.files.NioPathWatcher.handleEvent(NioPathWatcher.java:447)
	at com.swoval.files.NioPathWatcher.access$300(NioPathWatcher.java:35)
	at com.swoval.files.NioPathWatcher$2.accept(NioPathWatcher.java:108)
	at com.swoval.files.NioPathWatcher$2.accept(NioPathWatcher.java:102)
	at com.swoval.files.NioPathWatcherService$2.run(NioPathWatcherService.java:95)
[0m2021.02.27 15:05:01 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.02.27 15:05:01 INFO  time: indexed workspace in 1.78s[0m
[0m2021.02.27 15:18:32 INFO  compiling root (1 scala source)[0m
[0m2021.02.27 15:18:37 INFO  time: compiled root in 4.75s[0m
[0m2021.03.02 10:49:20 INFO  shutting down Metals[0m
[0m2021.03.02 10:49:20 INFO  Shut down connection with build server.[0m
[0m2021.03.02 10:49:20 INFO  Shut down connection with build server.[0m
[0m2021.03.02 10:49:20 INFO  Shut down connection with build server.[0m
No more data in the client stdin, exiting...
No more data in the client stdin, exiting...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
No more data in the client stdin, exiting...
[0m2021.03.15 08:56:49 INFO  Started: Metals version 0.10.0 in workspace '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp' for client vscode 1.53.2.[0m
[0m2021.03.15 08:56:49 INFO  time: initialize in 0.59s[0m
[0m2021.03.15 08:56:50 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher6489682808781615830/bsp.socket'...
Waiting for the bsp connection to come up...
[0m2021.03.15 08:56:49 INFO  skipping build import with status 'Installed'[0m
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
No server running at 127.0.0.1:8212, let's fire one...
Resolving ch.epfl.scala:bloop-frontend_2.12:1.4.8...
Starting bloop server at 127.0.0.1:8212...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Loading 2 projects from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop'...
[0m[32m[D][0m Loading project from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop/root-test.json'
[0m[32m[D][0m Loading project from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/.bloop/root.json'
[0m[32m[D][0m Cache miss for scala instance org.scala-lang:scala-compiler:2.11.12.
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/jline/jline/2.14.3/jline-2.14.3.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/modules/scala-parser-combinators_2.11/1.0.4/scala-parser-combinators_2.11-1.0.4.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/modules/scala-xml_2.11/1.0.5/scala-xml_2.11-1.0.5.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-compiler/2.11.12/scala-compiler-2.11.12.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-library/2.11.12/scala-library-2.11.12.jar
[0m[32m[D][0m   => /home/cjen/.cache/coursier/v1/https/repo1.maven.org/maven2/org/scala-lang/scala-reflect/2.11.12/scala-reflect-2.11.12.jar
[0m[32m[D][0m Configured SemanticDB in projects 'root', 'root-test'
[0m[32m[D][0m Missing analysis file for project 'root-test'
[0m[32m[D][0m Loading previous analysis for 'root' from '/home/cjen/210104-usf-bigdata/week8/ccrawlsapp/target/streams/compile/bloopAnalysisOut/_global/streams/inc_compile_2.11.zip'.
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher6489682808781615830/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher6489682808781615830/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.03.15 08:56:54 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.03.15 08:56:54 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
[0m2021.03.15 08:56:54 Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher3180929520713981694/bsp.socket'...
INFO  Attempting to connect to the build server...[0m
Waiting for the bsp connection to come up...
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher7706504067515765051/bsp.socket'...
Waiting for the bsp connection to come up...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher3180929520713981694/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher3180929520713981694/bsp.socket...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher7706504067515765051/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher7706504067515765051/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
Starting thread that pumps server stdout and redirects it to the client stdout...
[0m2021.03.15 08:56:55 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.03.15 08:56:55 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/cjen/.cache/metals/bsp.trace.json[0m
[0m2021.03.15 08:56:55 INFO  time: Connected to build server in 4.84s[0m
[0m2021.03.15 08:56:55 INFO  Connected to Build server: Bloop v1.4.8[0m
[0m2021.03.15 08:56:55 INFO  time: Imported build in 0.22s[0m
[0m2021.03.15 08:56:57 WARN  Could not find java sources in Some(/usr/lib/jvm/java-8-openjdk-amd64). Java symbols will not be available.[0m
[0m2021.03.15 08:56:57 INFO  time: indexed workspace in 2.94s[0m
[0m2021.03.15 11:10:47 INFO  shutting down Metals[0m
[0m2021.03.15 11:10:47 INFO  Shut down connection with build server.[0m
[0m2021.03.15 11:10:47 INFO  Shut down connection with build server.[0m
[0m2021.03.15 11:10:47 INFO  Shut down connection with build server.[0m
No more data in the client stdin, exiting...
No more data in the client stdin, exiting...
No more data in the client stdin, exiting...
